# 키친포스

## 요구 사항

### 상품 (Product)

- `상품`을 등록할 수 있다.
- `상품`의 가격이 올바르지 않으면 등록할 수 없다.
    - `상품`의 가격은 0 원 이상이어야 한다.
- `상품`의 목록을 조회할 수 있다.

### 메뉴 그룹 (MenuGroup)

> `메뉴 그룹`은 음식 서비스로 예를 들면 추천 메뉴로 분류할 수 있으며,  
> 추천 메뉴에는 여러 개의 메뉴를 표현할 수 있다.

- `메뉴 그룹`을 등록할 수 있다.
- `메뉴 그룹`의 목록을 조회할 수 있다.

### 메뉴 (Menu)

- `메뉴`를 등록할 수 있다.
- `메뉴`를 구성하는 `메뉴 상품`들에 `상품`이 존재하지 않으면 등록할 수 없다.
- `메뉴그룹`이 없다면 `메뉴`를 등록할 수 없다.
- `메뉴그룹`에 `메뉴`가 존재하지 않는다면 등록할 수 없다.
- `메뉴`의 가격이 올바르지 않으면 등록할 수 없다.
    - `메뉴`의 가격이 0 원 이상이어야 한다.
    - `메뉴`의 가격이 `메뉴 상품` 가격의 합보다 크다면 등록할 수 없다.
- `메뉴`의 목록을 조회 할 수 있다.
    - `메뉴` 목록 조회 시 `메뉴 상품`도 함께 조회한다.

### 주문 (Order)

- `주문`을 등록할 수 있다.
    - `주문 항목`이 없으면 주문할 수 없다.
    - `주문 항목`의 `메뉴`의 개수가 일치하지 않으면 주문 할 수 없다.
    - `주문`을 등록할 때 요청한 `주문 테이블`을 찾을 수 없으면 `주문` 할 수 없다.
    - `주문`을 등록할 때 요청한 `주문 테이블`이 존재하지 않으면 `주문` 할 수 없다.
- `주문`의 목록을 조회할 수 있다.
- `주문`의 `주문 상태`가 조리 또는 식사중 일 경우 `주문 상태`를 변경할 수 있다.
    - `주문`이 저장되어 있지 않으면 `주문 상태`를 변경할 수 없다.
    - `주문 상태`가 계산 완료인 경우 `주문 상태`를 변경할 수 없다.

### 단체 지정 (TableGroup)

- `단체 지정`을 등록할 수 있다.
    - `주문 테이블` 리스트가 없거나 테이블이 2개 미만이면 `테이블 그룹`을 등록할 수 없다.
    - `주문 테이블` 리스트가 저장된 `주문 테이블` 리스트의 개수와 일치하지 않으면 `테이블 그룹`을 등록할 수 없다.
    - `주문 테이블`이 비어있지 않거나 `주문 테이블`의 다른 그룹 테이블 정보가 있다면 `테이블 그룹`을 등록할 수 없다.
- 등록된 `단체 지정`을 해제할 수 있다.
    - `단체 지정`의 `주문 테이블` 리스트 중에 `주문 상태`가 조리 또는 식사 중인 경우 `단체 지정` 등록을 해제할 수 없다.

### 테이블 (Table)

- `테이블`을 등록할 수 있다.
- `테이블` 목록을 조회 할 수 있다.
- `주문 테이블` 상태를 `빈 테이블`로 변경할 수 있다.
    - `테이블`이 저장되어 있지 않으면 테이블의 상태를 변경할 수 없다.
    - `테이블`에 `테이블 그룹`이 등록되어 있다면 변경할 수 없다.
    - `주문 테이블`의 상태가 조리 또는 식사일 경우 테이블의 상태를 변경할 수 없다.
- `테이블`에 `방문한 손님 수`를 변경할 수 있다.
    - `방문한 손님 수`가 0보다 작다면 변경할 수 없다.
    - 요청한 `테이블`을 찾을 수 없으면 `방문한 손님 수`를 변경할 수 없다.
    - 요청한 `테이블`이 존재하지 않으면 `방문한 손님 수`를 변경할 수 없다.

## 용어 사전

| 영문명              | 한글명      | 설명                            |
|------------------|----------|-------------------------------|
| product          | 상품       | 메뉴를 관리하는 기준이 되는 데이터           |
| menu group       | 메뉴 그룹    | 메뉴 묶음, 분류                     |
| menu             | 메뉴       | 메뉴 그룹에 속하는 실제 주문 가능 단위        |
| menu product     | 메뉴 상품    | 메뉴에 속하는 수량이 있는 상품             |
| amount           | 금액       | 가격 * 수량                       |
| order table      | 주문 테이블   | 매장에서 주문이 발생하는 영역              |
| empty table      | 빈 테이블    | 주문을 등록할 수 없는 주문 테이블           |
| order            | 주문       | 매장에서 발생하는 주문                  |
| order status     | 주문 상태    | 주문은 조리 ➜ 식사 ➜ 계산 완료 순서로 진행된다. |
| number of guests | 방문한 손님 수 | 필수 사항은 아니며 주문은 0명으로 등록할 수 있다. |
| table group      | 단체 지정    | 통합 계산을 위해 개별 주문 테이블을 그룹화하는 기능 |
| order line item  | 주문 항목    | 주문에 속하는 수량이 있는 메뉴             |
| eat in           | 매장 식사    | 포장하지 않고 매장에서 식사하는 것           |

---

### 1단계 - 테스트를 통한 코드 보호

1. 요구사항
    - [x] `kitchenpos`패키지 코드를 보고 키친포스의 요구 사항을 README.md에 작성
    - [x] 키친포스의 요구 사항을 토대로 테스트 코드 작성
        - [x] 모든 Business Object에 대한 테스트 코드 작성
        - [x] SpringBootTest 이용한 통합 테스트 코드 또는 ExtendWith(mockitoExtension.class)를  
          이용한 단위 테스트 코드 작성
2. 프로그래밍 요구사항
    - 롬복 없이 미션 진행

### 2단계 - 서비스 리팩터링

1. 요구사항
    - [x] 단위 테스트하기 어려운 코드와 단위 테스트 가능한 코드를 분리해 단위 테스트 가능한 코드에 대한 단위 테스트 구현
        - [x] 테스트하기 쉬운 부분과 어려운 부분을 분리
            - [x] 테스트하기 쉬운 부분
                - [x] 서비스 영역에 있는 간단한 유효성 처리는 비즈니스 로직(도메인)으로 이동
                - [x] DB와 관련이 없는 요청에 의한 valid 체크 관련
            - [x] 어려운 부분
                - [x] 외부 요인으로 값이 변경하는 부분(작업중 확인 필요)
                - [x] 기본적으로 데이터가 있다는 전재를 깔고 있는 정보들(테이블그룹, 메뉴 상품, 기타 등등)
                - [x] 여러 정보가 조합된 상태로 판단하는 부분(주문 등록 같은 것)
            - [x] 패키지 분리를 분리해서 좀 더 보기 쉽게 정리
        - [x] 모델에 setter 메서드 넣지 않기

### 3단계 - 의존성 리팩터링

1. 요구사항
    - [x] 메뉴 정보가 변경되더라도 주문 항목이 변경되지 않게 구현
    - [x] 클래스 사이, 패키지 사이의 의존 관계는 단방향이 되도록 설정
        - [x] 함께 생성되고 함께 삭제되는 객체들을 묶기
        - [x] 불변식을 지켜야 하는 객체 묶기

### 4단계 - 멀티 모듈 적용

1. 요구사항
    - [x] Gradle의 멀티 모듈 개념을 적용해 자유롭게 서로 다른 프로젝트로 분리
        - [x] 컨텍스트 간의 독립된 모듈로 만들 수 있다.
        - [x] 계층 간의 독립된 모듈로 만들 수 있다.
    - [x] 의존성 주입, HTTP 요청/응답, 이벤트 발행 구독 등 다양한 방식으로 모듈 간 데이터 주고 받을 수 있다.
