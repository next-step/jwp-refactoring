# 키친포스
## 의존성 정리 요구사항
* 메뉴가 변경되어도 주문은 변경되면 안된다.
  * 객체들의 직접적인 연관관계를 간접으로 변경
* 패키지와 클래스간의 의존성을 단방향이 될 수 있도록 정리

## 요구 사항
```
** 상품 기능 요구사항 **
  1. 상품을 등록한다.
    * 상품은 가격이 없거나, 0보다 작을 수 없다.
      
  2. 상품 목록을 조회한다.
  
  3. 단일 상품을 조회한다.
    * 상품의 ID로 상품을 조회한다.
```
```
** 메뉴그룹 기능 요구사항 **
  1. 메뉴그룹을 등록한다.
      
  2. 메뉴그룹 목록을 조회한다.
  
  3. 단일 메뉴그룹을 조회한다.
    * 메뉴그룹의 ID로 메뉴그룹을 조회한다.
```
```
** 메뉴 기능 요구사항 **
  사전 공통 조건
    * 메뉴그룹이 등록되어 있어야 한다.
    * 상품이 등록되어 있어야 한다.

  1. 메뉴를 등록한다.
    * 메뉴는 가격이 없거나, 0보다 작을 수 없다.
    * 메뉴 등록요청 시 메뉴그룹(ManuGroup), 메뉴상품(MenuProduct)는 필수항목 
    * 메뉴의 가격은 메뉴에 속한 상품들의 가격의 합보다 작거나 같아야 한다.
    * 메뉴가 등록된 후 메뉴상품에 메뉴ID가 입력된다.
    
  2. 메뉴 목록을 조회한다.
    
  3. 단일 메뉴를 조회한다.
    * 메뉴의 ID로 메뉴를 조회한다.
```
```
** 주문 기능 요구사항 **
  사전 공통 조건
    * 상품이 등록되어 있어야 한다.
    * 메뉴그룹이 등록되어 있어야 한다.
    * 메뉴가 등록되어 있어야 한다.
    * 테이블이 등록되어 있어야 한다.

  1. 주문을 등록한다.
    * 주문 등록요청 시 주문항목(OrderLineItem), 테이블(OrdeTable)은 필수항목
    * 주문에는 하나이상의 메뉴가 속해있어야 한다.
    * 주문에 속한 메뉴는 모두 존재해야 한다.
    * 주문을 한 테이블이 존재해야 한다.
    * 주문을 한 테이블이 비어있으면 안 된다.
    * 주문을 등록할 때 등록시점의 시간이 기록된다.
    * 주문은 등록할 때 COOKING(요리)로 상태가 변경된다.
    * 주문은 COOKNING(요리) -> MEAL(식사중) -> COMPLETION(계산완료)의 상태를 가진다.
    
  2. 주문 목록을 조회한다.
    
  3. 단일 주문을 조회한다.
    * 주문의 ID로 주문을 조회한다.
  
  4. 주문 상태를 변경한다.
    * 주문이 등록되어 있어야 한다.
    * 주문의 상태는 COOKING(요리), MEAL(식사중) 중 하나이어야 한다.
```
```
** 테이블 기능 요구사항 **
  사전 공통 조건
  
  1. 테이블을 등록한다.
    * 테이블을 등록요청 시 테이블그룹에 속해있지 않아야 한다.
  
  2. 테이블 목록을 조회한다
  
  3. 테이블을 비어있는 상태로 변경한다.
    * 변경 요청 시 해당 테이블 ID, 변경 상태값 필수항목
    * 테이블이 등록되어 있어야 한다.
    * 상태를 변경하기 위해서 테이블그룹에 속해있으면 안 된다.
    * 해당 테이블의 주문은 계산완료된 상태여야 한다.
    
  4. 테이블의 손님 수를 변경한다.
    * 변경 요청시 해당 테이블 ID, 변경하고자 하는 손님 수 필수항목
    * 변경하고자 하는 손님 수는 0보다 작을 수 없다.
    * 해당 테이블은 존재해야 한다.
    * 테이블이 비어있으면 안 된다.  
```
```
** 테이블그룹 기능 요구사항 **
  사전 공통 조건
    * 테이블이 등록되어 있어야 한다.
  
  1. 테이블그룹을 등록한다.
    * 테이블그룹은 2개 이상의 테이블일 때 등록가능하다.
    * 테이블그룹으로 요청한 테이블은 모두 존재해야 한다.
    * 테이블그룹은 비어있는 테이블로만 요청이 가능하다.
    * 이미 다른 테이블그룹에 속해있는 테이블은 요청이 불가능하다.
    * 테이블그룹이 등록될 때 해당 테이블은 notEmpty상태가 된다.
    * 테이블그룹이 등록될 때 해당 테이블은 테이블그룹ID가 등록된다.
  
  2. 테이블그룹을 해제한다.
    * 테이블이 그룹화 되어있어야 한다.
    * 테이블그룹을 해제하기 위해서는 해당 테이블의 주문이 계산완료되어야 한다.
    * 테이블그룹이 해제될 때 테이블의 테이블그룹ID는 null로 변경된다.
```

  
## 리팩토링 예상목록
* **공통 사항**
  * Domain Entity로 변경
  * Controller 예외처리를 위한 ExceptionHandler 필요
  * 핵심 비즈니스로직 Service -> Domain 이동
  * 요청과 응답에 사용할 DTO 생성
  * 메서드 네이밍 적절한지 확인
  * 패키지 구조 Doamin기준으로 변경
  * 기존의 Service 테스트코드 통합테스트로 변경
  * 기존의 Controller 테스트코드 인수테스트로 변경

## 용어 사전

| 한글명 | 영문명 | 설명 |
| --- | --- | --- |
| 상품 | product | 메뉴를 관리하는 기준이 되는 데이터 |
| 메뉴 그룹 | menu group | 메뉴 묶음, 분류 |
| 메뉴 | menu | 메뉴 그룹에 속하는 실제 주문 가능 단위 |
| 메뉴 상품 | menu product | 메뉴에 속하는 수량이 있는 상품 |
| 금액 | amount | 가격 * 수량 |
| 주문 테이블 | order table | 매장에서 주문이 발생하는 영역 |
| 빈 테이블 | empty table | 주문을 등록할 수 없는 주문 테이블 |
| 주문 | order | 매장에서 발생하는 주문 |
| 주문 상태 | order status | 주문은 조리 ➜ 식사 ➜ 계산 완료 순서로 진행된다. |
| 방문한 손님 수 | number of guests | 필수 사항은 아니며 주문은 0명으로 등록할 수 있다. |
| 단체 지정 | table group | 통합 계산을 위해 개별 주문 테이블을 그룹화하는 기능 |
| 주문 항목 | order line item | 주문에 속하는 수량이 있는 메뉴 |
| 매장 식사 | eat in | 포장하지 않고 매장에서 식사하는 것 |
